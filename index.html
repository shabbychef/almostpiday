<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Backtesting</title>
  <meta name="description" content="">
  <meta name="author" content="Steven E. Pav">
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <link rel="stylesheet" href="libraries/frameworks/revealjs/css/reveal.min.css">
  <link rel="stylesheet" href="libraries/frameworks/revealjs/css/theme/sky.css" id="theme">
  <link rel="stylesheet" href="libraries/highlighters/highlight.js/css/tomorrow.css" id="theme">
  <!--[if lt IE 9]>
  <script src="lib/js/html5shiv.js"></script>
  <![endif]-->  <link rel="stylesheet" href = "libraries/widgets/bootstrap/css/bootstrap.css">
<link rel="stylesheet" href = "assets/css/ribbons.css">

</head>
<body>
  <div class="reveal">
    <div class="slides">
      <section class='' data-state='' id='slide-1'>
  
  <!-- zoom transition also good, but a little distracting -->

<!-- c.f.  
http://zevross.com/blog/2014/11/19/creating-elegant-html-presentations-that-feature-r-code/
http://stackoverflow.com/a/21468200/164611
https://github.com/hakimel/reveal.js/
https://j.eremy.net/align-lists-flush-left/
-->

<style type="text/css">
p { text-align: left; }
</style>

<h3>My background</h3>

<ul>
<li>Former applied mathematician. (IUB graduate!)</li>
<li>Quant Programmer &amp; Quant Strategist 2007-2015 at 
two small hedge funds.</li>
<li>Almost pure quant funds, ML-based, in U.S. (&quot;single name&quot;) equities and
volatility futures.</li>
<li>Tried many ML technologies to construct strategies: SVM, random forests, 
GP.</li>
<li>Also traditional statistical approaches: plain old regression.</li>
<li>Whatever the approach, we used <em>backtests</em>. (GP used them heavily.)</li>
</ul>

</section>
<section class='class' data-state='' id='backtests'>
  <h4>What makes a profitable strategy?</h4>
  <div align=left>
<ul>
<li> Need prediction of future price movements.
</ul>
</div>

<p>But also:</p>

<ul>
<li>Turn the predictions into trades.</li>
<li>No, <em>really</em>, turn the predictions into trades.</li>
<li>Eliminate or reduce exposure to certain risks.</li>
<li>Control trade costs. (commissions, short financing, market impact.)</li>
</ul>

<p>Hard to estimate the effects of the different moving parts separately.</p>

<p>So simulate your trading historically: A <em>backtest.</em></p>

<p>Backtesting basically implies quantitative strategies: you cannot backtest
discretionary trading.</p>

</section>
<section class='class' data-state='' id='whatdo'>
  <h3>Backtests</h3>
  <p>A backtest probably should:</p>

<ul>
<li>simulate the effects of your actions (orders submitted).</li>
<li>simulate the actions of the world (fills, commissions, corporate actions,
<em>etc</em>.).</li>
<li>translate in an obvious way to a real trading strategy.</li>
<li>provide an absolute guarantee of <em>time safety</em>.</li>
</ul>

<p>Creating a good backtesting environment requires:</p>

<ul>
<li>Software engineering: balance <em>time safety</em>, <em>computational efficiency</em>
and <em>developer sanity</em>.</li>
<li>Domain knowledge and data: <em>How should you simulate fill?</em>
<em>How do corporate actions work?</em></li>
<li>Great statistical powers: <em>How do you interpret the results?</em> <em>How do you
avoid overfitting?</em></li>
<li>Good intuition and sleuthing abilities: <em>What new thing is broken?</em></li>
</ul>

</section>
<section class='class' data-state='' id='kindsof'>
  <h3>Different kinds of backtests</h3>
  <p><center><img src="./figure/backtests.png" alt=""></center></p>

</section>
<section class='class' data-state='' id='garbatrage'>
  
  <style type="text/css">
p { text-align: left; }
</style>

<h3>Garbatrage</h3>

<p>Use Bayes&#39; Rule:</p>

<ul>
<li>Devising a consistently profitable trading strategy is known to be hard. <br>
(The EMH posits that it is essentially <em>impossible</em>.)</li>
<li>Bugs are easy to make. A good programmer will make several a day.</li>
</ul>

<p>If your backtest looks profitable, what is the likelihood the
strategy is really profitable?</p>

<p>If you are exploring a new asset class, using a new fill simulator, 
using new code, testing a new strategy, or reading a paper from a third party, 
and the backtest looks great, <em>it&#39;s probably a bug</em>.</p>

</section>
<section class='class' data-state='' id='anexample'>
  
  <style type="text/css">
p { text-align: center; } 
</style>

<h3>An example</h3>

<p>Should three day old tweets give you this?</p>

<p><img src="assets/fig/bmzsim-1.png" title="plot of chunk bmzsim" alt="plot of chunk bmzsim" width="900px" height="500px" /></p>

<style type="text/css">
p { text-align: left; }
</style>

</section>
<section class='class' data-state='' id='timetravelzero'>
  <h3>Time Travel</h3>
  <p>The most common error in backtests is <em>time travel</em>: use of future information 
in simulations.</p>

<p>Time travel occurs for many reasons:</p>

<ul>
<li>Backfill and survivorship bias.</li>
<li>Representation of corporate actions: dividends, splits, spinoffs, mergers,
warrants.</li>
<li>Think-os and code boo boos.</li>
</ul>

<p>Time travel is easy to simulate, but hard to implement!</p>

</section>
<section class='class' data-state='' id='survivorship'>
  <h3>Survivorship and Backfill</h3>
  <ul>
<li>Classic survivorship bias: trading on a universe of stocks
defined by <em>present</em> membership in some index, say.</li>
<li>Data vendors often backfill data for companies or remove them.
(You can test for this, or just ask them!)</li>
<li>Vendors may do weird things to deal with mergers (or you may!)</li>
</ul>

</section>
<section class='class' data-state='' id='corporate'>
  <h3>Corporate Actions</h3>
  <ul>
<li>Corporate actions are notoriously time-leaky.</li>
<li>Problems stem from representing asset returns as a single time series: in reality, they
<em>branch</em> across time.</li>
<li>Corporate actions are just 
<a href="http://www.denisonmines.com/s/Corporate_History.asp">hard to model</a>.</li>
</ul>

<p>For example, (back) adjusted closes. Investing inversely proportional to
adjusted close gives a time-travel &#39;arb&#39;.</p>

<p><img src="assets/fig/aapl-1.png" title="plot of chunk aapl" alt="plot of chunk aapl" width="900px" height="400px" /></p>

</section>
<section class='class' data-state='' id='mlhackerone'>
  <h3>The ML Hacker Trap</h3>
  <ul>
<li>Align returns to features for training ML models.</li>
<li>Forget that the model is timestamped to the <em>returns</em>.</li>
<li>A warning: <em>the more often I retrain, the better
my model!</em>
(Often with an excuse for &#39;time freshness&#39;.)</li>
</ul>

<p><center><img src="./figure/align1.png" alt=""></center></p>

</section>
<section class='class' data-state='' id='mlhackertwo'>
  <h3>The ML Hacker Trap</h3>
  <ul>
<li>Align returns to features for training ML models.</li>
<li>Forget that the model is timestamped to the <em>returns</em>.</li>
<li>A warning: <em>the more often I retrain, the better
my model!</em>
(Often with an excuse for &#39;time freshness&#39;.)</li>
</ul>

<p><center><img src="./figure/align2.png" alt=""></center></p>

</section>
<section class='class' data-state='' id='break'>
  <h2>Break!</h2>
  <p>Time permitting, talk about overfitting later.</p>

<p>Turn it over to Zak for the next part.</p>

</section>
<section class='class' data-state='' id='ohno'>
  <h3>Again!?</h3>
  <p><center><img src="./figure/Curve_fitting.jpg" alt=""></center></p>

</section>
<section class='class' data-state='' id='fooz'>
  <h2>Plain Old Overfitting</h2>
  <p>When backtests are fixed, you can move on to overfitting.</p>

<p>Overfitting has two flavors here:</p>

<ol>
<li>a.</li>
<li>b.</li>
</ol>

<p>Equations:</p>

<p>\[
x = \sum_{0 \le i \le 100} i^2
\]</p>

</section>
    </div>
  </div>
</body>
  <script src="libraries/frameworks/revealjs/lib/js/head.min.js"></script>
  <script src="libraries/frameworks/revealjs/js/reveal.min.js"></script>
  <script>
  // Full list of configuration options available here:
  // https://github.com/hakimel/reveal.js#configuration
  Reveal.initialize({
    controls: true,
    progress: true,
    history: true,
    center: false,
    theme: Reveal.getQueryHash().theme || 'sky', 
    transition: Reveal.getQueryHash().transition || 'none', 
    dependencies: [
    // Cross-browser shim that fully implements classList -
    // https://github.com/eligrey/classList.js/
      { src: 'libraries/frameworks/revealjs/lib/js/classList.js', condition: function() { return !document.body.classList;}},
      // Zoom in and out with Alt+click
      { src: 'libraries/frameworks/revealjs/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
      // Speaker notes
      { src: 'libraries/frameworks/revealjs/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
      // Remote control your reveal.js presentation using a touch device
      //{ src: 'libraries/frameworks/revealjs/plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
      ]
  });
  </script>  <!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<!-- <script src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script> -->
<script>window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="libraries/widgets/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"><\/script>')
</script>
<script>  
$(function (){ 
  $("#example").popover(); 
  $("[rel='tooltip']").tooltip(); 
});  
</script>  
<!-- LOAD HIGHLIGHTER JS FILES -->
<script src="libraries/highlighters/highlight.js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<!-- DONE LOADING HIGHLIGHTER JS FILES -->
 

</html>